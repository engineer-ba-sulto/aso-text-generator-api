### チケット: P1-概要 CSV 分析と主要キーワード選定エンジンの実装

#### 背景 / 目的

- **背景**: プロジェクト基盤（ステップ 0）は整備済みだが、CSV ファイルの分析と主要キーワードの自動選定機能が未実装
- **目的**: CSV ファイルからキーワードデータを分析し、ランキング・人気度・難易度を考慮したスコアリングシステムにより最適な主要キーワードを自動選定する機能を実装する

#### スコープ（このチケットでやること）

ステップ 1 では以下の 3 つのサブタスクを順次実装します：

1. **P1-001: CSV データモデルとバリデーション**

   - Pydantic を使った CSV データモデルの定義
   - 必須カラム（キーワード、ランキング、人気度、難易度）の検証
   - データ型と値の範囲チェック
   - CSV ファイルの構造検証

2. **P1-002: キーワードスコアリング**

   - 各キーワードの評価スコア算出アルゴリズムの実装
   - ランキング、人気度、難易度の重み付け計算
   - スコア正規化とランキング機能
   - スコアリング結果のキャッシュ機能

3. **P1-003: 主要キーワードの自動選定**

   - 最高スコアキーワードの自動選定ロジック
   - 単一主要キーワードの確定
   - 選定結果の検証とログ出力
   - エラーハンドリングとフォールバック機能

#### やらないこと（Out of Scope）

- ルールベース＆統計ベースのテキスト生成機能の実装（STEP2 で対応）
- Gemini 連携とクリエイティブテキスト生成機能の実装（STEP3 で対応）
- API エンドポイントの統合と MVP リリース（STEP4 で対応）
- 多言語対応のテキスト生成（言語非依存の分析機能のみ）

#### 受入条件（Acceptance Criteria）

- 全サブタスク（P1-001〜003）が完了していること
- CSV ファイルの適切なバリデーションが動作すること
- キーワードスコアリングが正確に計算されること
- 主要キーワードが自動的に選定されること
- エラーハンドリングが適切に動作すること
- 単体テストが実装され、カバレッジが 80%以上であること

#### 影響/変更ファイル

- 追加:
  - `app/models/csv_models.py` (CSV データモデル)
  - `app/services/csv_analyzer.py` (CSV 分析サービス)
  - `app/services/keyword_selector.py` (キーワード選定サービス)
  - `tests/test_csv_analyzer.py` (CSV 分析テスト)
  - `tests/test_keyword_selector.py` (キーワード選定テスト)
- 変更:
  - `app/models/request_models.py` (CSV リクエストモデルの拡張)
  - `app/models/response_models.py` (CSV 分析レスポンスモデルの拡張)
  - `app/utils/exceptions.py` (CSV 関連例外の追加)

#### 依存関係 / ブロッカー

- **依存**: ステップ 0（プロジェクト基盤）の完了
- **ブロッカー**: なし
- **後続**: ステップ 2（テキスト生成機能）は本ステップの完了に依存

#### 参考資料

- `docs/MVP開発ロードマップ.md` の「ステップ 1：CSV 分析と主要キーワード選定エンジンの実装」
- `docs/PRD.md` の CSV 分析要件
- `docs/ASO戦略ルールまとめ.md` のキーワード選定ルール

#### リスク / 留意点

- **データ品質**: CSV ファイルの品質に依存するため、適切なバリデーションが重要
- **スコアリング精度**: キーワードスコアリングの重み付けパラメータの調整が必要
- **パフォーマンス**: 大量のキーワードデータを処理する際の性能最適化
- **エラーハンドリング**: 不正な CSV ファイルや空データへの対応
- **テストデータ**: 実際の ASO データに近いテストデータの準備

#### 見積り

- 12 時間（計画準拠）
  - P1-001: 4 時間（CSV データモデルとバリデーション）
  - P1-002: 5 時間（キーワードスコアリング）
  - P1-003: 3 時間（主要キーワード自動選定）
